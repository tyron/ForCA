{{for eval in evals:}}
<div class='grade{{=eval['grade']}}'>
	<table>
		<tr>
			<td rowspan='4'>
				<div style='font-size:xx-large'>
					<b>{{=eval['grade']}}</b>
				</div>
			</td>
			<td>
				<table>
					<tr>
						{{if 'disc_name' in eval:}}
							<b>{{=eval['aluno_name']}}</b>, sobre <b>{{=eval['disc_name']}}</b>
						{{else:}}
							<b>{{=eval['aluno_name']}}</b>, sobre <b>{{=eval['prof_name']}}</b>
						{{pass}}
						{{if 'semester' in eval:}}
							em <b>{{=eval['semester']}}</b>:
						{{else:}}
							:
						{{pass}}
					</tr>
					<tr>
						<td>
							<i>{{=eval['comment'] or 'sem comentário'}}</i><br />
						</td>
					</tr>
				</table>
			</td>
		</tr>
		<div style='float:right'>
			<b>
				{{if not has_karmed(get_aluno_id(), eval['id']) and get_aluno_id() and get_aluno_id()!=eval['aluno_id']:}}
					<form><input type="hidden" id="karma{{=eval['id']}}"/></form>

					<span id="plus{{=eval['id']}}" style="float:right" 
						onclick="ajax('{{=URL(request.application, 'karma', 'up', vars=dict(eval_id=eval['id']))}}', 
						['karma{{=eval['id']}}'], 'karma_count{{=eval['id']}}');
						jQuery('#plus{{=eval['id']}}').fadeOut();
						jQuery('#minus{{=eval['id']}}').fadeOut();">
						{{=IMG(_src=URL('static', 'thumb-up.png'))}}
					</span>

					<span style="float:right" id="karma_count{{=eval['id']}}" 
						class="karma-{{='plus' if eval['karma'] >= 0 else 'minus'}}">{{=eval['karma']}}</span>

					<span id="minus{{=eval['id']}}" style="float:right" 
						onclick="ajax('{{=URL(request.application, 'karma', 'down', vars=dict(eval_id=eval['id']))}}', 
						['karma{{=eval['id']}}'], 'karma_count{{=eval['id']}}');
						jQuery('#plus{{=eval['id']}}').fadeOut();
						jQuery('#minus{{=eval['id']}}').fadeOut();">
						{{=IMG(_src=URL('static', 'thumb-down.png'))}}</span>
				{{else:}}
				<span style="float:right" class="karma-{{='plus' if eval['karma'] >= 0 else 'minus'}}">{{=eval['karma']}}</span>
				{{pass}}
			</b>
		</div>
		{{if session.auth:}}
			{{if eval['aluno_user_id'] == session.auth.user.id:}}
				{{if 'prof' in request.vars:}}
					{{=A('Editar', _href=URL(request.application, 'eval', 'update', vars=dict(eval_id=eval['id'], prof_id=prof.id)))}}<br/>
				{{else:}}
					{{=A('Editar', _href=URL(request.application, 'eval', 'update', vars=dict(eval_id=eval['id'], disc_id=disc.id)))}}<br/>
				{{pass}}
			{{pass}}
		{{pass}}
		</tr>
	</table>
</div><br/>
{{pass}}<br/>

{{if 'prof' in request.vars:}}
	{{=A('Adicionar avaliação', _href=URL(request.application, 'eval', 'create', vars=dict(prof_id=prof.id)))}}
{{else:}}
	{{=A('Adicionar avaliação', _href=URL(request.application, 'eval', 'create', vars=dict(disc_id=disc.id)))}}
{{pass}}
